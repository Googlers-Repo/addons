(()=>{"use strict";var e={800:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.loadMessageBundle=t.localize=t.format=t.setPseudo=t.isPseudo=t.isDefined=t.BundleFormat=t.MessageFormat=void 0;var r,n,s,a=o(926);function i(e){return void 0!==e}function c(e,o){return t.isPseudo&&(e="［"+e.replace(/[aouei]/g,"$&$&")+"］"),0===o.length?e:e.replace(/\{(\d+)\}/g,(function(e,t){var r=t[0],n=o[r],s=e;return"string"==typeof n?s=n:"number"!=typeof n&&"boolean"!=typeof n&&null!=n||(s=String(n)),s}))}(s=t.MessageFormat||(t.MessageFormat={})).file="file",s.bundle="bundle",s.both="both",(n=t.BundleFormat||(t.BundleFormat={})).standalone="standalone",n.languagePack="languagePack",function(e){e.is=function(e){var t=e;return t&&i(t.key)&&i(t.comment)}}(r||(r={})),t.isDefined=i,t.isPseudo=!1,t.setPseudo=function(e){t.isPseudo=e},t.format=c,t.localize=function(e,t){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];return c(t,o)},t.loadMessageBundle=function(e){return(0,a.default)().loadMessageBundle(e)},t.config=function(e){return(0,a.default)().config(e)}},926:(e,t)=>{var o;function r(){if(void 0===o)throw new Error("No runtime abstraction layer installed");return o}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");o=e}}(r||(r={})),t.default=r},472:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.loadMessageBundle=t.BundleFormat=t.MessageFormat=void 0;var r=o(622),n=o(747),s=o(926),a=o(800),i=o(800);Object.defineProperty(t,"MessageFormat",{enumerable:!0,get:function(){return i.MessageFormat}}),Object.defineProperty(t,"BundleFormat",{enumerable:!0,get:function(){return i.BundleFormat}});var c,l,u=Object.prototype.toString;function d(e){return"[object Number]"===u.call(e)}function f(e){return"[object String]"===u.call(e)}function g(e){return JSON.parse(n.readFileSync(e,"utf8"))}function h(e){return function(t,o){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return d(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: ".concat(new Error("").stack)):(0,a.format)(e[t],r):f(o)?(console.warn("Message ".concat(o," didn't get externalized correctly.")),(0,a.format)(o,r)):void console.error("Broken localize call found. Stacktrace is\n: ".concat(new Error("").stack))}}function p(e,t){return c[e]=t,t}function v(e){try{return function(e){var t=g(r.join(e,"nls.metadata.json")),o=Object.create(null);for(var n in t){var s=t[n];o[n]=s.messages}return o}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function m(e,t){var o;if(!0===l.languagePackSupport&&void 0!==l.cacheRoot&&void 0!==l.languagePackId&&void 0!==l.translationsConfigFile&&void 0!==l.translationsConfig)try{o=function(e,t){var o,s,a,i=r.join(l.cacheRoot,"".concat(e.id,"-").concat(e.hash,".json")),c=!1,u=!1;try{return o=JSON.parse(n.readFileSync(i,{encoding:"utf8",flag:"r"})),s=i,a=new Date,n.utimes(s,a,a,(function(){})),o}catch(e){if("ENOENT"===e.code)u=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: ".concat(e.message,".")),n.unlink(i,(function(e){e&&console.error("Deleting corrupted bundle ".concat(i," failed."))})),c=!0}}if(!(o=function(e,t){var o=l.translationsConfig[e.id];if(o){var n=g(o).contents,s=g(r.join(t,"nls.metadata.json")),a=Object.create(null);for(var i in s){var c=s[i],u=n["".concat(e.outDir,"/").concat(i)];if(u){for(var d=[],h=0;h<c.keys.length;h++){var p=c.keys[h],v=u[f(p)?p:p.key];void 0===v&&(v=c.messages[h]),d.push(v)}a[i]=d}else a[i]=c.messages}return a}}(e,t))||c)return o;if(u)try{n.writeFileSync(i,JSON.stringify(o),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return o;throw e}return o}(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!o){if(l.languagePackSupport)return v(t);var s=function(e){for(var t=l.language;t;){var o=r.join(e,"nls.bundle.".concat(t,".json"));if(n.existsSync(o))return o;var s=t.lastIndexOf("-");t=s>0?t.substring(0,s):void 0}if(void 0===t&&(o=r.join(e,"nls.bundle.json"),n.existsSync(o)))return o}(t);if(s)try{return g(s)}catch(e){console.log("Loading in the box message bundle failed.",e)}o=v(t)}return o}function k(e){if(!e)return a.localize;var t=r.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),l.messageFormat===a.MessageFormat.both||l.messageFormat===a.MessageFormat.bundle){var o=function(e){for(var t,o=r.dirname(e);t=r.join(o,"nls.metadata.header.json"),!n.existsSync(t);){var s=r.dirname(o);if(s===o){t=void 0;break}o=s}return t}(e);if(o){var s=r.dirname(o),i=c[s];if(void 0===i)try{var u=JSON.parse(n.readFileSync(o,"utf8"));try{var d=m(u,s);i=p(s,d?{header:u,nlsBundle:d}:null)}catch(e){console.error("Failed to load nls bundle",e),i=p(s,null)}}catch(e){console.error("Failed to read header file",e),i=p(s,null)}if(i){var f=e.substr(s.length+1).replace(/\\/g,"/"),v=i.nlsBundle[f];return void 0===v?(console.error("Messages for file ".concat(e," not found. See console for details.")),function(){return"Messages not found."}):h(v)}}}if(l.messageFormat===a.MessageFormat.both||l.messageFormat===a.MessageFormat.file)try{var k=g(function(e){var t;if(l.cacheLanguageResolution&&t)t=t;else{if(a.isPseudo||!l.language)t=".nls.json";else for(var o=l.language;o;){var r=".nls."+o+".json";if(n.existsSync(e+r)){t=r;break}var s=o.lastIndexOf("-");s>0?o=o.substring(0,s):(t=".nls.json",o=null)}l.cacheLanguageResolution&&(t=t)}return e+t}(e));return Array.isArray(k)?h(k):(0,a.isDefined)(k.messages)&&(0,a.isDefined)(k.keys)?h(k.messages):(console.error("String bundle '".concat(e,"' uses an unsupported format.")),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file ".concat(e)),function(){return"Failed to load message bundle. See console for details."}}function w(e){return e&&(f(e.locale)&&(l.locale=e.locale.toLowerCase(),l.language=l.locale,c=Object.create(null)),void 0!==e.messageFormat&&(l.messageFormat=e.messageFormat),e.bundleFormat===a.BundleFormat.standalone&&!0===l.languagePackSupport&&(l.languagePackSupport=!1)),(0,a.setPseudo)("pseudo"===l.locale),k}!function(){if(l={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:a.MessageFormat.bundle},f(process.env.VSCODE_NLS_CONFIG))try{var e=JSON.parse(process.env.VSCODE_NLS_CONFIG),t=void 0;if(e.availableLanguages){var o=e.availableLanguages["*"];f(o)&&(t=o)}if(f(e.locale)&&(l.locale=e.locale.toLowerCase()),void 0===t?l.language=l.locale:"en"!==t&&(l.language=t),function(e){return!0===e||!1===e}(e._languagePackSupport)&&(l.languagePackSupport=e._languagePackSupport),f(e._cacheRoot)&&(l.cacheRoot=e._cacheRoot),f(e._languagePackId)&&(l.languagePackId=e._languagePackId),f(e._translationsConfigFile)){l.translationsConfigFile=e._translationsConfigFile;try{l.translationsConfig=g(l.translationsConfigFile)}catch(t){if(e._corruptedFile){var s=r.dirname(e._corruptedFile);n.exists(s,(function(t){t&&n.writeFile(e._corruptedFile,"corrupted","utf8",(function(e){console.error(e)}))}))}}}}catch(e){}(0,a.setPseudo)("pseudo"===l.locale),c=Object.create(null)}(),t.loadMessageBundle=k,t.config=w,s.default.install(Object.freeze({loadMessageBundle:k,config:w}))},129:e=>{e.exports=require("child_process")},747:e=>{e.exports=require("fs")},622:e=>{e.exports=require("path")},549:e=>{e.exports=require("vscode")}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=o(622),n=o(747),s=o(129),a=o(549),i=o(472).loadMessageBundle(o(622).join(__dirname,"main.ts"));function c(e){return new Promise(((t,o)=>{n.exists(e,(e=>{t(e)}))}))}const l=["build","compile","watch"];function u(e){for(const t of l)if(-1!==e.indexOf(t))return!0;return!1}const d=["test"];function f(e){for(const t of d)if(-1!==e.indexOf(t))return!0;return!1}let g,h;function p(){return g||(g=a.window.createOutputChannel("Grunt Auto Detection")),g}function v(){a.window.showWarningMessage(i(0,null),i(1,null)).then((()=>{p().show(!0)}))}async function m(e){let o;const r=process.platform;return o="win32"===r&&await c(t.join(e,"node_modules",".bin","grunt.cmd"))?t.join(".","node_modules",".bin","grunt.cmd"):"linux"!==r&&"darwin"!==r||!await c(t.join(e,"node_modules",".bin","grunt"))?"grunt":t.join(".","node_modules",".bin","grunt"),o}class k{constructor(e,t){this._workspaceFolder=e,this._gruntCommand=t}get workspaceFolder(){return this._workspaceFolder}isEnabled(){return"on"===a.workspace.getConfiguration("grunt",this._workspaceFolder.uri).get("autoDetect")}start(){const e=t.join(this._workspaceFolder.uri.fsPath,"{node_modules,[Gg]runtfile.js}");this.fileWatcher=a.workspace.createFileSystemWatcher(e),this.fileWatcher.onDidChange((()=>this.promise=void 0)),this.fileWatcher.onDidCreate((()=>this.promise=void 0)),this.fileWatcher.onDidDelete((()=>this.promise=void 0))}async getTasks(){return this.isEnabled()?(this.promise||(this.promise=this.computeTasks()),this.promise):[]}async getTask(e){const t=e.definition,o=t.task;if(o){const e={cwd:this.workspaceFolder.uri.fsPath},r="grunt";return-1===o.indexOf(" ")?new a.Task(t,this.workspaceFolder,o,r,new a.ShellExecution(`${await this._gruntCommand}`,[o,...t.args],e)):new a.Task(t,this.workspaceFolder,o,r,new a.ShellExecution(`${await this._gruntCommand}`,[`"${o}"`,...t.args],e))}}async computeTasks(){const e="file"===this._workspaceFolder.uri.scheme?this._workspaceFolder.uri.fsPath:void 0,o=[];if(!e)return o;if(!await c(t.join(e,"gruntfile.js"))&&!await c(t.join(e,"Gruntfile.js")))return o;const r=`${await this._gruntCommand} --help --no-color`;try{const{stdout:t,stderr:o}=await(n=r,l={cwd:e},new Promise(((e,t)=>{s.exec(n,l,((o,r,n)=>{o&&t({error:o,stdout:r,stderr:n}),e({stdout:r,stderr:n})}))})));o&&(p().appendLine(o),v());const i=[];if(t){const e=t.split(/\r{0,1}\n/);let o=!1,r=!1;for(const t of e)if(0!==t.length)if(o||r){if(o&&!r)if(0===t.indexOf("Tasks run in the order specified"))r=!0;else{const e=/^\s*(\S.*\S)  \S/g.exec(t);if(e&&2===e.length){const t=e[1],o={type:"grunt",task:t},r="grunt",n={cwd:this.workspaceFolder.uri.fsPath},s=-1===t.indexOf(" ")?new a.Task(o,this.workspaceFolder,t,r,new a.ShellExecution(`${await this._gruntCommand} ${t}`,n)):new a.Task(o,this.workspaceFolder,t,r,new a.ShellExecution(`${await this._gruntCommand} "${t}"`,n));i.push(s);const c=t.toLowerCase();u(c)?s.group=a.TaskGroup.Build:f(c)&&(s.group=a.TaskGroup.Test)}}}else 0===t.indexOf("Available tasks")&&(o=!0)}return i}catch(e){const t=p();return e.stderr&&t.appendLine(e.stderr),e.stdout&&t.appendLine(e.stdout),t.appendLine(i(2,null,this.workspaceFolder.name,e.error?e.error.toString():"unknown")),v(),o}var n,l}dispose(){this.promise=void 0,this.fileWatcher&&this.fileWatcher.dispose()}}class w{constructor(){this.detectors=new Map}start(){const e=a.workspace.workspaceFolders;e&&this.updateWorkspaceFolders(e,[]),a.workspace.onDidChangeWorkspaceFolders((e=>this.updateWorkspaceFolders(e.added,e.removed))),a.workspace.onDidChangeConfiguration(this.updateConfiguration,this)}dispose(){this.taskProvider&&(this.taskProvider.dispose(),this.taskProvider=void 0),this.detectors.clear()}updateWorkspaceFolders(e,t){for(const e of t){const t=this.detectors.get(e.uri.toString());t&&(t.dispose(),this.detectors.delete(e.uri.toString()))}for(const t of e){const e=new k(t,m(t.uri.fsPath));this.detectors.set(t.uri.toString(),e),e.isEnabled()&&e.start()}this.updateProvider()}updateConfiguration(){for(const e of this.detectors.values())e.dispose(),this.detectors.delete(e.workspaceFolder.uri.toString());const e=a.workspace.workspaceFolders;if(e)for(const t of e)if(!this.detectors.has(t.uri.toString())){const e=new k(t,m(t.uri.fsPath));this.detectors.set(t.uri.toString(),e),e.isEnabled()&&e.start()}this.updateProvider()}updateProvider(){if(!this.taskProvider&&this.detectors.size>0){const e=this;this.taskProvider=a.tasks.registerTaskProvider("grunt",{provideTasks:()=>e.getTasks(),resolveTask:t=>e.getTask(t)})}else this.taskProvider&&0===this.detectors.size&&(this.taskProvider.dispose(),this.taskProvider=void 0)}getTasks(){return this.computeTasks()}computeTasks(){if(0===this.detectors.size)return Promise.resolve([]);if(1===this.detectors.size)return this.detectors.values().next().value.getTasks();{const e=[];for(const t of this.detectors.values())e.push(t.getTasks().then((e=>e),(()=>[])));return Promise.all(e).then((e=>{const t=[];for(const o of e)o&&o.length>0&&t.push(...o);return t}))}}async getTask(e){if(0!==this.detectors.size){if(1===this.detectors.size)return this.detectors.values().next().value.getTask(e);if(e.scope!==a.TaskScope.Workspace&&e.scope!==a.TaskScope.Global&&e.scope){const t=this.detectors.get(e.scope.uri.toString());if(t)return t.getTask(e)}}}}e.activate=function(e){h=new w,h.start()},e.deactivate=function(){h.dispose()}})();var n=exports;for(var s in r)n[s]=r[s];r.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/129500ee4c8ab7263461ffe327268ba56b9f210d/extensions/grunt/dist/main.js.map